<!DOCTYPE html>
<html lang="es">
<head>
<link rel="stylesheet" href="style.css">
  <meta charset="UTF-8">
  <title>Espermatog茅nesis</title>
  <style>
    body {
      background-color: #FCF9EA;
      color: #000;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: auto; 
      text-align: center;
    }

    .titulo-con-imagenes {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
      margin-bottom: 20px;
    }

    .titulo-con-imagenes img {
      width: 120px;
      height: auto;
      border-radius: 12px;
    }

    h1 {
      font-size: 2.2em;
      color: #000;
      margin: 10px 0;
    }

    h2, h3 {
      margin: 5px 0;
      color: #000;
    }

    #info {
      max-width: 800px;
      width: 90%;
      background: #F5D2D2;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }

    p {
      font-size: 1em;
      text-align: justify;
      margin: 10px 0;
      color: #000;
    }

    button {
      background-color: #FFBDBD;
      color: #000;
      border: none;
      padding: 12px 25px;
      font-size: 1.1em;
      font-weight: bold;
      border-radius: 25px;
      cursor: pointer;
      transition: 0.3s;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      margin-top: 20px;
    }

    button:hover {
      background-color: #2980b9;
      transform: scale(1.05);
    }

    #ar-container {
      width: 100%;
      height: 500px;
      display: none;
    }

    /*  Bot贸n de salir anclado abajo a la derecha */
    #exit-ar {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 1000;
      padding: 12px 18px;
      background-color: rgba(0, 0, 0, 0.65);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 1em;
      cursor: pointer;
      backdrop-filter: blur(5px);
      display: none;
      align-items: center;
      gap: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.4);
      transition: background-color 0.3s ease, transform 0.2s ease;
    }

    #exit-ar:hover {
      background-color: rgba(255, 0, 0, 0.7);
      transform: scale(1.05);
    }

    #exit-ar svg {
      width: 18px;
      height: 18px;
      fill: white;
    }
  </style>

  <!-- A-Frame y AR.js -->
  <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aframe-extras@7.0.0/dist/aframe-extras.min.js"></script>
<!-- Librerias Movimientoo -->
  <script src="https://cdn.jsdelivr.net/gh/fcor/arjs-gestures@master/gesture-detector.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/fcor/arjs-gestures@master/gesture-handler.js"></script>

</head>
<body>

  <!-- Secci贸n principal -->
<!-- Secci贸n principal -->
<div id="info">
  <div class="titulo-con-imagenes">
    <img src="imagenes/medicina logo.png" alt="Logo Medicina">
    <h1>Espermatog茅nesis</h1>
    <img src="imagenes/univesidad logo.png" alt="Logo Universidad">
  </div>
  <h2>Museo de Embriolog铆a</h2>
  <h3>Universidad Aut贸noma de Chihuahua</h3>
  <p>La embriolog铆a es el estudio del desarrollo del embri贸n desde la fecundaci贸n del 贸vulo hasta la octava semana de gestaci贸n...</p>
  <p>Con esta aplicaci贸n usted podr谩 obtener una experiencia de realidad aumentada donde podr谩 ver modelos 3D de la espermatog茅nesis.</p>

  <div id="menu-modelos">
    <h3>Seleccione un modelo para visualizar:</h3>
    <button data-model="testiculo"> Test铆culo</button>
    <button data-model="engranes"> Engranes</button>
    <button data-model="animacion"> Animaci贸n</button>
  </div>
</div>

<!-- Modal (ventana emergente) -->
<div id="modal-modelo" class="modal">
  <div class="modal-content">
    <h2 id="modal-titulo"></h2>
    <p id="modal-descripcion"></p>
    <button id="start-ar">Iniciar Realidad Aumentada</button>
    <button id="cerrar-modal">Cerrar</button>
  </div>
</div>


  <!-- Bot贸n con 铆cono de salida -->
  <button id="exit-ar">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
      <path d="M18.3 5.71a1 1 0 0 0-1.42 0L12 10.59 7.11 5.7a1 1 0 0 0-1.42 1.42L10.59 12l-4.9 4.89a1 1 0 0 0 1.42 1.42L12 13.41l4.89 4.9a1 1 0 0 0 1.42-1.42L13.41 12l4.89-4.89a1 1 0 0 0 0-1.4z"/>
    </svg>
    Salir
  </button>

  <!-- Contenedor para la escena AR -->
  <div id="ar-container"></div>

<script>
  const info = document.getElementById('info');
  const arContainer = document.getElementById('ar-container');
  const exitBtn = document.getElementById('exit-ar');

  // Modal
  const modal = document.getElementById('modal-modelo');
  const modalTitulo = document.getElementById('modal-titulo');
  const modalDescripcion = document.getElementById('modal-descripcion');
  const startBtn = document.getElementById('start-ar');
  const cerrarModal = document.getElementById('cerrar-modal');

  // Informaci贸n de cada modelo
  const modelosInfo = {
    testiculo: {
      titulo: "Modelo del Test铆culo",
      descripcion: "No s茅 que poner"
    },
    engranes: {
      titulo: "Modelo de Engranes",
      descripcion: "Anane."
    },
    animacion: {
      titulo: "Modelo Animado",
      descripcion: "Todo eso."
    }
  };

  // Cuando se da clic en un modelo
  document.querySelectorAll('#menu-modelos button').forEach(btn => {
    btn.addEventListener('click', () => {
      const modelKey = btn.getAttribute('data-model');
      const modelData = modelosInfo[modelKey];
      modalTitulo.textContent = modelData.titulo;
      modalDescripcion.textContent = modelData.descripcion;
      modal.style.display = 'flex';

      // Guardar modelo elegido
      startBtn.dataset.model = modelKey;
    });
  });

  // Cerrar modal
  cerrarModal.addEventListener('click', () => {
    modal.style.display = 'none';
  });

  // Iniciar AR al presionar el bot贸n del modal
  startBtn.addEventListener('click', () => {
    modal.style.display = 'none';
    info.style.display = 'none';
    exitBtn.style.display = 'flex';
    arContainer.style.display = 'block';

    const modelKey = startBtn.dataset.model;

    // Crear la escena AR
    const scene = document.createElement('a-scene');
    scene.setAttribute('embedded', '');
    scene.setAttribute('arjs', '');
    scene.setAttribute('gesture-detector', '');

    // Seleccionar modelo seg煤n el elegido
    let marker = document.createElement('a-marker');
    let model = document.createElement('a-entity');

    if (modelKey === "testiculo") {
      marker.setAttribute('preset', 'hiro');
      model.setAttribute('gltf-model', 'models/embriologia/transparente.glb');
      model.setAttribute('scale', '0.2 0.2 0.2');
      model.setAttribute('rotation', '90 0 180');
    }
    else if (modelKey === "engranes") {
      marker.setAttribute('preset', 'kanji');
      model.setAttribute('gltf-model', 'models/gears/gears.glb');
      model.setAttribute('scale', '0.1 0.1 0.1');
    }
    else if (modelKey === "animacion") {
      marker.setAttribute('type', 'pattern');
      marker.setAttribute('url', 'markers/pattern-marcaCreeper.patt');
      model.setAttribute('gltf-model', 'models/embriologia/Pruebas.glb');
      model.setAttribute('position', '0 0 0');
      model.setAttribute('rotation', '0 0 0');
      model.setAttribute('scale', '0.2 0.2 0.2');
      model.setAttribute('animation-mixer', '');
    }

    model.setAttribute('gesture-handler', '');
    marker.appendChild(model);
    scene.appendChild(marker);

    const camera = document.createElement('a-entity');
    camera.setAttribute('camera', '');
    scene.appendChild(camera);

    arContainer.innerHTML = '';
    arContainer.appendChild(scene);
  });

  // Bot贸n para salir de AR
  exitBtn.addEventListener('click', () => {
    arContainer.style.display = 'none';
    arContainer.innerHTML = '';
    info.style.display = 'block';
    exitBtn.style.display = 'none';

    const video = document.querySelector('video');
    if (video && video.srcObject) {
      const stream = video.srcObject;
      const tracks = stream.getTracks();
      tracks.forEach(track => track.stop());
      video.srcObject = null;
    }

    setTimeout(() => { window.location.reload(); }, 300);
  });
</script>


</body>
</html>
